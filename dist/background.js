(()=>{"use strict";({994:function(){var e=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))((function(n,s){function a(e){try{r(o.next(e))}catch(e){s(e)}}function d(e){try{r(o.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,d)}r((o=o.apply(e,t||[])).next())}))};let t,i=[];new Map,chrome.windows.onCreated.addListener((e=>{let t={window:e,tabs:new Map};i.push(t)})),chrome.runtime.onConnect.addListener((o=>{o.onMessage.addListener((n=>{"getCurrentTab"===n.action&&function(o){e(this,void 0,void 0,(function*(){try{t=yield chrome.tabs.query({active:!0,currentWindow:!0});for(let e=0;e<i.length;e++)if(t[0].windowId===i[e].window.id){i[e].tabs.set(o.additionalInfo.index,t[0]),yield chrome.storage.session.set({windowsData:i});let n=yield chrome.storage.session.get(["windowsData"]);console.log("this is after the update ",n.windowsData);break}}catch(e){console.log("error getting tab",e)}}))}(n),"switchTab"===n.action&&function(t){e(this,void 0,void 0,(function*(){let e=t.additionalInfo.indexKey,o=yield chrome.windows.getCurrent();for(let t=0;t<i.length;t++)if(o.id===i[t].window.id){let o=i[t].tabs.get(e.toLocaleLowerCase());if(!o)return void console.log(o);chrome.tabs.update(Number(o.id),{active:!0});break}}))}(n),"getTabs"===n.action&&function(t,o){e(this,void 0,void 0,(function*(){let e=yield chrome.windows.getLastFocused();for(let n=0;n<i.length;n++)if(e.id===i[n].window.id){o.postMessage((t=i[n].tabs,Array.from(t.entries())));break}var t}))}(0,o),"ping"===n.action&&console.log("Received ping, service worker is alive")})),o.onDisconnect.addListener((()=>e(void 0,void 0,void 0,(function*(){yield chrome.storage.session.set({windowsData:i})}))))})),function(){(()=>{e(this,void 0,void 0,(function*(){var e,t,o,n;try{let s=yield chrome.storage.session.get(["windowsData"]);if(s.windowsData){console.log("this is from session",s.windowsData),i=s.windowsData;for(let o=0;o<i.length;o++){let n=null===(e=i[o].window)||void 0===e?void 0:e.tabs;if(n)for(let e=0;e<n.length;e++){let i=null===(t=n[e])||void 0===t?void 0:t.id;if(!i)throw`tab id unvalid ${n[o]}`;chrome.scripting.executeScript({target:{tabId:i},files:["dist/content.js"]})}}return}let a=yield chrome.windows.getAll({populate:!0});for(let e=0;e<a.length;e++){let t={window:a[e],tabs:new Map};i.push(t);let s=null===(o=a[e])||void 0===o?void 0:o.tabs;if(s)for(let t=0;t<s.length;t++){let i=null===(n=s[t])||void 0===n?void 0:n.id;if(!i)throw`tab id unvalid ${s[e]}`;chrome.scripting.executeScript({target:{tabId:i},files:["dist/content.js"]})}}}catch(e){console.log("error populating window",e)}console.log("all windoes",i)}))})()}()}})[994]()})();